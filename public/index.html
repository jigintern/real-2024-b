<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
    <title>HeyHey</title>
    <link rel="stylesheet" href="style.css" />
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const signUpButton = document.getElementById("signUpButton");
        const nameInput = document.getElementById("nameInput");
        const activeInput = document.getElementById("activeInput");
        const name = localStorage.getItem("name");
        const active = localStorage.getItem("active");
        if (name && active) {
          window.location.href = "/main.html";
        } else if (name) {
          nameInput.value = name;
          document.getElementById("iconImg").src = localStorage.getItem("icon");
        }

        signUpButton.addEventListener("click", function (event) {
          localStorage.setItem("name", nameInput.value);     // save name
          localStorage.setItem("active", activeInput.value); // save activity
        });
      });
      function previewIcon(input) {
        // ファイルが選択されているか確認
        if (input.files && input.files[0]) {
          const reader = new FileReader();
          // 画像ファイルを読み込み終えたときに発生するイベント
          reader.onload = function (e) {
            // 画像タグのsrcを読み込んだ画像のデータURLに変更
            document.getElementById("iconImg").src = e.target.result;
            localStorage.setItem("icon", e.target.result);
          };
          // ファイルをデータURLとして読み込む
          reader.readAsDataURL(input.files[0]);
        }
      }
    </script>
  </head>
  <body>
    <form action="main.html">
      <div id="container">
        <div class="inputContainer">
          <label>名前</label>
          <input type="text" id="nameInput" placeholder="名前を入力" />
        </div>

        <div id="icon">
          <img src="img/noImage.jpg" alt="icon image" id="iconImg" />
          <input type="file" id="iconInput" onchange="previewIcon(this)" />
        </div>
        <div class="inputContainer">

          <label>最近の出来事</label>
          <input
            type="text"
            id="activeInput"
            placeholder="最近の出来事を入力"
          />
        </div>
        <div class="buttonContainer">
          <button id="signUpButton">Start</button>
        </div>
      </div>
    </form>
  </body>
</html>
